{% extends './../frame.html' %}
{% block content %}

<table class="table table-hover table-striped table-condensed">
    <thead>
        <tr>
            <th>#</th>
            <th>Account</th>
            <th>Student ID</th>
            <th>User</th>
            <th>Group</th>
            <th>Execute</th>
            <th>Verdict</th>
            <th>Created At</th>
        </tr>
        <tr>
        </tr>
    </thead>
    <tbody>
        {% for x in data %}
            <tr>
                <td>{{x["id"]}}</td>
                <td>{{x["account"]}}</td>
                <td>{{x["student_id"]}}</td>
                <td>
                    <div onclick="update({{x['id']}}, 1);" class="btn btn-sm {{ "btn-success" if map_power['user_manage'] in x['power'] else "btn-danger"}}">
                        {{ "Yes" if map_power['user_manage'] in x['power'] else "No"}}
                    </div>
                </td>
                <td>
                    <div onclick="update({{x['id']}}, 2);" class="btn btn-sm {{ "btn-success" if map_power['group_manage'] in x['power'] else "btn-danger"}}">
                        {{ "Yes" if map_power['group_manage'] in x['power'] else "No"}}
                    </div>
                </td>
                <td>
                    <div onclick="update({{x['id']}}, 3);" class="btn btn-sm {{ "btn-success" if map_power['execute_manage'] in x['power'] else "btn-danger"}}">
                        {{ "Yes" if map_power['execute_manage'] in x['power'] else "No"}}
                    </div>
                </td>
                <td>
                    <div onclick="update({{x['id']}}, 4);" class="btn btn-sm {{ "btn-success" if map_power['verdict_manage'] in x['power'] else "btn-danger"}}">
                        {{ "Yes" if map_power['verdict_manage'] in x['power'] else "No"}}
                    </div>
                </td>
                <td>{{x["created_at"]}}</td>
            </tr>
        {% end %}
    </tbody>
</table>
{% module Pagination(page) %}
<script>
function update(id, power_type){
    $.ajax({
        url: '/api/users/'+id+'/',
        type: "POST",
        data: {
            'power': power_type,
            'token': "{{account['token']}}"
        },
        dataType: "json",
        success: function(msg){
            if(msg["status"] == 200){
                location.href = location.href;
            } else {
                alert(msg['msg']);
            }
        }
    });
}
</script>

{% end %}
